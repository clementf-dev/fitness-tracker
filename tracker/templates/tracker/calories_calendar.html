{% extends 'tracker/base.html' %}

{% block title %}Calendrier Calories - Fitness Tracker{% endblock %}

{% block extra_css %}
<style>
    .cal-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }

    .cal-nav a {
        padding: 0.5rem 1rem;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.05);
        color: var(--text-primary);
        text-decoration: none;
        transition: all 0.3s;
    }

    .cal-nav a:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    .cal-month-title {
        font-size: 1.5rem;
        font-weight: 600;
        text-transform: capitalize;
    }

    .cal-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
    }

    .cal-header {
        text-align: center;
        padding: 0.5rem;
        font-weight: 600;
        color: var(--text-secondary);
        font-size: 0.85rem;
    }

    .cal-day {
        min-height: 80px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 0.5rem;
        transition: all 0.2s;
    }

    .cal-day:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.2);
    }

    .cal-day.empty {
        background: transparent;
        border-color: transparent;
    }

    .cal-day.today {
        border-color: #667eea;
        box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
    }

    .cal-day-number {
        font-weight: 600;
        font-size: 0.9rem;
        margin-bottom: 0.25rem;
    }

    .cal-day-calories {
        font-size: 0.85rem;
        font-weight: 600;
        color: #f5576c;
    }

    .cal-day.has-data .cal-day-calories {
        color: #2ecc71;
    }

    .cal-day a {
        color: inherit;
        text-decoration: none;
        display: block;
        height: 100%;
    }
</style>
{% endblock %}

{% block content %}
<div class="animate-in">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 style="font-weight: 700; font-size: 2rem;">üìÖ Calendrier Calories</h1>
        <a href="{% url 'calories_dashboard' %}" class="btn btn-primary">‚Üê Retour au suivi</a>
    </div>

    <!-- Navigation du mois -->
    <div class="cal-nav">
        <a href="?year={{ prev_year }}&month={{ prev_month }}">‚Üê Mois pr√©c√©dent</a>
        <span class="cal-month-title">{{ month_name }}</span>
        <a href="?year={{ next_year }}&month={{ next_month }}">Mois suivant ‚Üí</a>
    </div>

    <!-- Calendrier -->
    <div class="card">
        <div class="card-body">
            <div class="cal-grid">
                <!-- En-t√™te jours de la semaine -->
                <div class="cal-header">Lun</div>
                <div class="cal-header">Mar</div>
                <div class="cal-header">Mer</div>
                <div class="cal-header">Jeu</div>
                <div class="cal-header">Ven</div>
                <div class="cal-header">Sam</div>
                <div class="cal-header">Dim</div>

                <!-- Jours du mois -->
                {% for week in weeks_data %}
                {% for day in week %}
                {% if day %}
                <div class="cal-day {% if day.is_today %}today{% endif %} {% if day.has_data %}has-data{% endif %}">
                    <a href="{% url 'calories_dashboard_date' date_str=day.date|date:'Y-m-d' %}">
                        <div class="cal-day-number">{{ day.day }}</div>
                        {% if day.calories > 0 %}
                        <div class="cal-day-calories">{{ day.calories }} kcal</div>
                        {% else %}
                        <div class="cal-day-calories" style="color: var(--text-secondary);">-</div>
                        {% endif %}
                    </a>
                </div>
                {% else %}
                <div class="cal-day empty"></div>
                {% endif %}
                {% endfor %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}